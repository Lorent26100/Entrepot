/****** Object:  View [dbo].[v_BI_Dim_Plan_Comptable]    Committed by VersionSQL https://www.versionsql.com ******/

CREATE   VIEW [dbo].[v_BI_Dim_Plan_Comptable] AS SELECT
V300CPTE.F300KY AS Code, 
V300CPTE.F300ACTIF AS Actif, 
F001SOC.F001KY AS Societe, 
CASE WHEN (V929TABLEVIR.F901MSG IS NOT NULL) THEN V929TABLEVIR.F901MSG ELSE V300CPTE.F901MSG  end AS Libelle
  FROM
  F001SOC
  CROSS JOIN V300CPTE
LEFT OUTER JOIN  V929TABLEVIR ON(  V929TABLEVIR.F929931VALEUR = V300CPTE.F300KY AND V929TABLEVIR.L929930TAB = 'F300CPTE' AND  V929TABLEVIR.L929931CHAMP = 'F300KY' AND  V929TABLEVIR.L929931CHAMPVIR = 'F30ALIBPARSOC' AND  V929TABLEVIR.K929001SOC = F001SOC.F001KY )
